{"version":3,"file":"background.js","mappings":";;;;;;;;;;;;;;;;AAAA,gBAAgB,SAAI,IAAI,SAAI;AAC5B;AACA,iDAAiD,OAAO;AACxD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACO;AACP,0DAA0D,8EAA8E;AACxI;AACA;AACA,oEAAoE,QAAQ,qLAAqL;AACjQ,2CAA2C,aAAa,uFAAuF;AAC/I,oFAAoF,0BAA0B;AAC9G;AACA;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;UC1CA;UACA;;UAEA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;;UAEA;UACA;;UAEA;UACA;UACA;;;;;WCtBA;WACA;WACA;WACA;WACA,yCAAyC,wCAAwC;WACjF;WACA;WACA;;;;;WCPA;;;;;WCAA;WACA;WACA;WACA,uDAAuD,iBAAiB;WACxE;WACA,gDAAgD,aAAa;WAC7D;;;;;;;;;;;;;ACNA,iBAAiB,SAAI,IAAI,SAAI;AAC7B,4BAA4B,+DAA+D,iBAAiB;AAC5G;AACA,oCAAoC,MAAM,+BAA+B,YAAY;AACrF,mCAAmC,MAAM,mCAAmC,YAAY;AACxF,gCAAgC;AAChC;AACA,KAAK;AACL;AACA,mBAAmB,SAAI,IAAI,SAAI;AAC/B,cAAc,6BAA6B,0BAA0B,cAAc,qBAAqB;AACxG,iBAAiB,oDAAoD,qEAAqE,cAAc;AACxJ,uBAAuB,sBAAsB;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA,wCAAwC;AACxC,mCAAmC,SAAS;AAC5C,mCAAmC,WAAW,UAAU;AACxD,0CAA0C,cAAc;AACxD;AACA,8GAA8G,OAAO;AACrH,iFAAiF,iBAAiB;AAClG,yDAAyD,gBAAgB,QAAQ;AACjF,+CAA+C,gBAAgB,gBAAgB;AAC/E;AACA,kCAAkC;AAClC;AACA;AACA,UAAU,YAAY,aAAa,SAAS,UAAU;AACtD,oCAAoC,SAAS;AAC7C;AACA;AAC8D;AACkC;AAChG;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA,CAAC;AACD;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA,wCAAwC,qBAAqB;AAC7D;AACA;AACA;AACA;AACA,6DAA6D,0JAAe;AAC5E;AACA;AACA;AACA,oDAAoD,oEAAe;AACnE;AACA;AACA,wEAAwE,2EAAsB;AAC9F,yCAAyC;AACzC;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB;AACzB,qBAAqB;AACrB,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4CAA4C,oEAAe;AAC3D,4CAA4C,oEAAe;AAC3D;AACA,wFAAwF,+BAA+B;AACvH;AACA;AACA;AACA;AACA,yBAAyB;AACzB;AACA,iBAAiB;AACjB;AACA;AACA;AACA,oBAAoB;AACpB;AACA;AACA;AACA,oBAAoB;AACpB;AACA;AACA,SAAS;AACT,KAAK;AACL,CAAC","sources":["webpack://my-webpack-project/./src/shared/utils/utils.ts","webpack://my-webpack-project/webpack/bootstrap","webpack://my-webpack-project/webpack/runtime/define property getters","webpack://my-webpack-project/webpack/runtime/hasOwnProperty shorthand","webpack://my-webpack-project/webpack/runtime/make namespace object","webpack://my-webpack-project/./src/backgroundScripts/background.ts"],"sourcesContent":["var __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nexport var getParamFromUrl = function (url) {\n    // Разбиваем строку запроса на отдельные параметры\n    var params = new URLSearchParams(url);\n    // Создаем пустой объект для хранения параметров\n    var paramsObj = {};\n    // Проходимся по всем параметрам и добавляем их в объект\n    params.forEach(function (value, key) {\n        var keyArr = key === null || key === void 0 ? void 0 : key.split(\"?\");\n        var keyValue = keyArr.length > 1 ? keyArr[1] : keyArr[0];\n        paramsObj[keyValue] = value;\n    });\n    return paramsObj;\n};\nexport var entitiesForPasteInsert = function (entities, idEntities) {\n    var currentEntities = entities.find(function (item) { return (item === null || item === void 0 ? void 0 : item.Id) === idEntities; });\n    var arrNested = [];\n    var findNested = function (entiti) {\n        var chieldNesrtedEntiti = entities.filter(function (item) { var _a; return ((_a = item === null || item === void 0 ? void 0 : item.Parent) === null || _a === void 0 ? void 0 : _a.Id) === (entiti === null || entiti === void 0 ? void 0 : entiti.Id); });\n        arrNested.push(__assign(__assign({}, entiti), { isCurrent: (entiti === null || entiti === void 0 ? void 0 : entiti.Id) === idEntities }));\n        chieldNesrtedEntiti.length && chieldNesrtedEntiti.forEach(function (item) { return findNested(item); });\n    };\n    findNested(currentEntities);\n    return arrNested;\n};\nexport function getUrlParameter(location, name) {\n    name = name.replace(/[\\[]/, \"\\\\[\").replace(/[\\]]/, \"\\\\]\");\n    var regex = new RegExp(\"[\\\\?&]\" + name + \"=([^&#]*)\");\n    var results = regex.exec(location);\n    return results === null\n        ? \"\"\n        : decodeURIComponent(results[1].replace(/\\+/g, \" \"));\n}\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (g && (g = 0, op[0] && (_ = 0)), _) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nimport { EntitiesService } from \"@/services/Entities.service\";\nimport { entitiesForPasteInsert, getParamFromUrl, getUrlParameter } from \"@/shared/utils/utils\";\nvar arrUrlHeaders = [];\nchrome.webRequest.onHeadersReceived.addListener(function (details) {\n    if (details.url.includes('navigate')) {\n        arrUrlHeaders.push({\n            url: details.url,\n            objUrl: new URL(details.url),\n            responseHeaders: details.responseHeaders || []\n        });\n    }\n}, {\n    urls: [\"<all_urls>\"],\n}, [\"responseHeaders\"]);\nchrome.runtime.onMessage.addListener(function (request, sender, sendResponse) {\n    return __awaiter(this, void 0, void 0, function () {\n        var responseHeaders;\n        return __generator(this, function (_a) {\n            if (request.action === 'getEntities') {\n                chrome.cookies.getAll({ url: sender.tab.url }, function (cookies) {\n                    return __awaiter(this, void 0, void 0, function () {\n                        var response, idEntites;\n                        return __generator(this, function (_a) {\n                            switch (_a.label) {\n                                case 0: return [4 /*yield*/, EntitiesService.getEntities(request.payload)];\n                                case 1:\n                                    response = _a.sent();\n                                    try {\n                                        idEntites = getParamFromUrl(sender.tab.url).id;\n                                        chrome.tabs.sendMessage(sender.tab.id, {\n                                            action: 'postEntitiesForPasteInsert',\n                                            payload: Array.from(new Set(entitiesForPasteInsert(response, idEntites)))\n                                        });\n                                    }\n                                    catch (error) {\n                                        console.log(\"🚀 ~ file: background.ts:60 ~ error:\", error);\n                                    }\n                                    return [2 /*return*/];\n                            }\n                        });\n                    });\n                });\n            }\n            if (request.action === 'getUrlDevServer') {\n                console.log('arrUrlHeaders', arrUrlHeaders);\n                console.log('one', new Date().getMinutes());\n                responseHeaders = [];\n                arrUrlHeaders.forEach(function (element) {\n                    console.log('two', new Date().getMinutes());\n                    // console.log(getUrlParameter(element.objUrl.search, 'objectId'), 'id')\n                    console.log('request', request.payload);\n                    console.log(\"🚀 ~ file: background.ts:59 ~ request:\", request);\n                    console.log('headers ', getUrlParameter(element.objUrl.search, 'objectId'));\n                    if (request.payload === getUrlParameter(element.objUrl.search, 'objectId')) {\n                        console.log(555, element.responseHeaders);\n                        var urlFromServer = element.responseHeaders.find(function (_) { return _.name === \"Location\"; }).value;\n                        var devUrl = urlFromServer.replace(\"https://localhost:5001\", \"http://localhost:3000\");\n                        chrome.tabs.sendMessage(sender.tab.id, {\n                            action: 'postUrlDevServer',\n                            payload: devUrl\n                        });\n                    }\n                });\n                // chrome.tabs.sendMessage(sender.tab.id, {\n                //     action: 'postUrlDevServer',\n                //     payload:\n                // });\n                // chrome.tabs.sendMessage(sender.tab.id, {\n                //     action: 'postEntitiesForPasteInsert',\n                //     payload: Array.from(new Set(entitiesForPasteInsert(response, idEntites)))\n                // });\n            }\n            return [2 /*return*/];\n        });\n    });\n});\n"],"names":[],"sourceRoot":""}